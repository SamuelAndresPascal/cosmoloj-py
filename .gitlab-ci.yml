default:
  before_script:
    - echo $CONDA_HOME
    - PATH=$PATH:$CONDA_HOME/bin
    - python --version
    - conda --version
    - which python
    - conda init bash
    - conda create -n cosmoloj_py python=3.10
    - . ~/.bashrc
    - conda activate cosmoloj_py
    - which python
    - conda install pylint pytest

  after_script:
    - PATH=$PATH:$CONDA_HOME/bin
    - python --version
    - conda --version
    - which python
    - conda init bash
    - . ~/.bashrc
    - conda activate cosmoloj_py
    - which python
    - conda remove pylint pytest

stages:
  - lint
  - test
  - package
  - demo

lint:unit-simple:
  stage: lint
  script:
    - cd unit-simple
    - pylint --rcfile=../pylintrc unit_simple.py
    - pip install .
    - pylint --rcfile=../pylintrc demo.py
    - pylint --rcfile=../pylintrc test.py
    - pylint --rcfile=../pylintrc unit_simple_test.py

test:unit-simple:
  stage: test
  script:
    - cd unit-simple
    - pytest
    - python test.py

package:unit-simple:
  stage: package
  script:
    - cd unit-simple
    - pip install --upgrade build
    - python -m build
    - pip uninstall build

demo:unit-simple:
  stage: demo
  script:
    - cd unit-simple
    - python demo.py
